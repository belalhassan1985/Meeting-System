# ๐ ูุธุงู ุงููุตุงุฏูุฉ ุงูููุญุฏ - Unified Authentication System

## ๐ ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ

### โ ูุง ุชู ุชูููุฐู:

#### 1. **ุฏูุฌ ุฌุฏุงูู ุงููุณุชุฎุฏููู**
- โ ุฏูุฌ ุฌุฏูู `admins` ูุน ุฌุฏูู `users`
- โ ุฅุถุงูุฉ ุญูู `role` (admin/user)
- โ ููู ุฌููุน ุงููุณุคูููู ุฅูู ุฌุฏูู users

#### 2. **ูุธุงู ูุตุงุฏูุฉ ููุญุฏ**
- โ ููุทุฉ ุฏุฎูู ูุงุญุฏุฉ: `/login`
- โ API endpoint ูุงุญุฏ: `/users/login`
- โ ุงูุชูุฌูู ุงูุชููุงุฆู ุจูุงุกู ุนูู ุงูู role

#### 3. **ุงูุชุญูู ุจุงูุตูุงุญูุงุช**
- โ ุงููุณุคูููู (admin): ูุฏุฎููู `/admin`
- โ ุงููุณุชุฎุฏููู (user): ูุฏุฎููู `/dashboard`
- โ ุญูุงูุฉ ุงูุตูุญุงุช ุจูุงุกู ุนูู ุงูู role

#### 4. **ูุธุงู ุนุถููุฉ ุงูุบุฑู**
- โ ุฅูุดุงุก ุฌุฏูู `room_members`
- โ ุฑุจุท ุงููุณุชุฎุฏููู ุจุงูุบุฑู
- ๐ **ููุฏ ุงูุชุทููุฑ**: ุนุฑุถ ุงูุบุฑู ุงููุณุฌู ูููุง ุงููุณุชุฎุฏู ููุท

---

## ๐๏ธ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู `users`:
```sql
- id (UUID)
- name (VARCHAR)
- username (VARCHAR UNIQUE)
- password (VARCHAR)
- email (VARCHAR NULLABLE)
- role (ENUM: 'admin', 'user')  โ ุฌุฏูุฏ
- isActive (BOOLEAN)
- createdAt (TIMESTAMP)
- updatedAt (TIMESTAMP)
```

### ุฌุฏูู `room_members`:
```sql
- id (UUID)
- roomId (UUID) โ rooms(id)
- userId (UUID) โ users(id)
- joinedAt (TIMESTAMP)
- UNIQUE(roomId, userId)
```

---

## ๐ ูุธุงู ุงููุตุงุฏูุฉ

### ุชุณุฌูู ุงูุฏุฎูู:
```
URL: /login (ุตูุญุฉ ูุงุญุฏุฉ ููุฌููุน)
API: POST /users/login
Body: { username, password }
Response: { token, user: { id, username, name, email, role } }
```

### ุงูุชูุฌูู ุงูุชููุงุฆู:
```javascript
if (user.role === 'admin') {
  redirect('/admin')
} else {
  redirect('/dashboard')
}
```

---

## ๐ฅ ุงููุณุชุฎุฏููู ุงูุญุงูููู

| Username | Password | Name | Role |
|----------|----------|------|------|
| `admin` | `admin123` | ุงููุณุคูู ุงูุฑุฆูุณู | admin |
| `testuser` | `123456` | ูุณุชุฎุฏู ุชุฌุฑูุจู | user |
| `ุนูู` | `123456` | ุนูู | user |
| `yyyyy` | `123456` | yyyyy | user |
| `ุจูุงูุญุณูุนุฐุงุจ` | `123456` | ุจูุงู ุญุณู ุนุฐุงุจ | user |

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุคูููู:
1. ุงูุชุญ: `http://localhost:3002/login`
2. ุณุฌู ุฏุฎูู ุจู: `admin` / `admin123`
3. ุณูุชู ุชูุฌููู ุชููุงุฆูุงู ุฅูู `/admin`
4. ูุฏูู ุตูุงุญูุงุช ูุงููุฉ:
   - ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
   - ุฅุฏุงุฑุฉ ุงูุบุฑู
   - ุฅุถุงูุฉ ูุณุชุฎุฏููู ููุบุฑู
   - ุนุฑุถ ุณุฌูุงุช ุงูุฃุญุฏุงุซ

### ูููุณุชุฎุฏููู:
1. ุงูุชุญ: `http://localhost:3002/login`
2. ุณุฌู ุฏุฎูู ุจู: `testuser` / `123456`
3. ุณูุชู ุชูุฌููู ุชููุงุฆูุงู ุฅูู `/dashboard`
4. ุชุฑู ููุท:
   - ุงูุบุฑู ุงููุณุฌู ูููุง
   - ุฅูุดุงุก ุบุฑู ุฌุฏูุฏุฉ
   - ุงูุงูุถูุงู ูุบุฑู ุจุงูููุฏ

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### Backend:
- โ `apps/api/src/entities/user.entity.ts` - ุฅุถุงูุฉ role
- โ `apps/api/src/services/user.service.ts` - ุฏุนู roles
- โ `apps/api/src/entities/room-member.entity.ts` - ุฌุฏูุฏ
- โ `apps/api/scripts/merge-admin-users.js` - ุฏูุฌ ุงูุฌุฏุงูู
- โ `apps/api/scripts/create-room-members-table.js` - ุฌุฏูู ุงูุฃุนุถุงุก

### Frontend:
- โ `apps/web/src/app/login/page.tsx` - ุชูุฌูู ุจูุงุกู ุนูู role
- โ `apps/web/src/app/page.tsx` - ุชูุฌูู ููุญุฏ
- โ `apps/web/src/app/dashboard/page.tsx` - ุญูุงูุฉ ุงููุณุชุฎุฏููู
- โ `apps/web/src/app/admin/layout.tsx` - ุญูุงูุฉ ุงููุณุคูููู
- โ `apps/web/src/app/user-login/` - ุชู ุญุฐููุง

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ููุฏ ุงูุชุทููุฑ)

### 1. ุชุญุฏูุซ RoomService
- [ ] ุฅุถุงูุฉ ูุธุงุฆู ุฅุฏุงุฑุฉ ุฃุนุถุงุก ุงูุบุฑู
- [ ] `addMemberToRoom(roomId, userId)`
- [ ] `removeMemberFromRoom(roomId, userId)`
- [ ] `getRoomMembers(roomId)`
- [ ] `getUserRooms(userId)`

### 2. ุชุญุฏูุซ RoomController
- [ ] ุฅุถุงูุฉ endpoints ูุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก
- [ ] `POST /rooms/:id/members`
- [ ] `DELETE /rooms/:id/members/:userId`
- [ ] `GET /rooms/:id/members`

### 3. ุชุญุฏูุซ Dashboard
- [ ] ุนุฑุถ ุงูุบุฑู ุงููุณุฌู ูููุง ุงููุณุชุฎุฏู ููุท
- [ ] ุฑุณุงูุฉ "ูุง ุชูุฌุฏ ุบุฑู ูุชุงุญุฉ" ุฅุฐุง ูู ููู ูุณุฌู ูู ุฃู ุบุฑูุฉ

### 4. ุชุญุฏูุซ Admin Panel
- [ ] ุฅุถุงูุฉ ูุงุฌูุฉ ูุฅุฏุงุฑุฉ ุฃุนุถุงุก ุงูุบุฑู
- [ ] ุฅุถุงูุฉ/ุญุฐู ูุณุชุฎุฏููู ูู ุงูุบุฑู
- [ ] ุนุฑุถ ูุงุฆูุฉ ุงูุฃุนุถุงุก ููู ุบุฑูุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู:
```bash
# ููุณุคูู
curl -X POST http://localhost:3001/users/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

# ููุณุชุฎุฏู
curl -X POST http://localhost:3001/users/login \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","password":"123456"}'
```

### ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
cd apps/api
node scripts/check-users.js
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุฌุฏูู admins ุงููุฏูู
- ูุง ูุฒุงู ููุฌูุฏุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูููู ุญุฐูู ุจุนุฏ ุงูุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู:
```sql
DROP TABLE admins;
```

### 2. Token Storage
- ุชู ุชูุญูุฏ ุงูุชุฎุฒูู:
  - `localStorage.getItem('token')` โ ุจุฏูุงู ูู userToken
  - `localStorage.getItem('userInfo')` โ ููุญุฏ ููุฌููุน

### 3. ุงูุตูุญุงุช ุงููุญุฐููุฉ
- `/user-login` - ุชู ุญุฐููุง
- ุงูุขู ุงูุฌููุน ูุณุชุฎุฏู `/login`

---

## ๐ฏ ุงูููุงุฆุฏ

1. **ุจุณุงุทุฉ**: ููุทุฉ ุฏุฎูู ูุงุญุฏุฉ ููุฌููุน
2. **ุฃูุงู**: ุญูุงูุฉ ุจูุงุกู ุนูู ุงูู role
3. **ูุฑููุฉ**: ุณูููุฉ ุฅุถุงูุฉ roles ุฌุฏูุฏุฉ
4. **ูุถูุญ**: ููุฏ ุฃูุธู ูุฃุณูู ูู ุงูุตูุงูุฉ
5. **ุชุญูู**: ุงููุณุชุฎุฏููู ูุฑูู ููุท ูุง ูุฎุตูู

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุฃูุฏ ูู ุชุดุบูู Backend ุนูู port 3001
2. ุชุฃูุฏ ูู ุชุดุบูู Frontend ุนูู port 3002
3. ุงูุณุญ cache ุงููุชุตูุญ
4. ุชุญูู ูู console ุงููุชุตูุญ ููุฃุฎุทุงุก

---

**ุชู ุงูุชุญุฏูุซ:** 14 ูุจุฑุงูุฑ 2026
**ุงูุญุงูุฉ:** โ ูุธุงู ุงููุตุงุฏูุฉ ุงูููุญุฏ ูุนูู | ๐ ูุธุงู ุนุถููุฉ ุงูุบุฑู ููุฏ ุงูุชุทููุฑ
